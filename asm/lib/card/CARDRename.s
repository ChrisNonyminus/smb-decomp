.include "macros.inc"

.section .text, "ax"  # 0x800065A0 - 0x8010F860

.global CARDRenameAsync
CARDRenameAsync:
/* 800DB8AC 000D77CC  7C 08 02 A6 */	mflr r0
/* 800DB8B0 000D77D0  90 01 00 04 */	stw r0, 4(r1)
/* 800DB8B4 000D77D4  94 21 FF B8 */	stwu r1, -0x48(r1)
/* 800DB8B8 000D77D8  BE E1 00 24 */	stmw r23, 0x24(r1)
/* 800DB8BC 000D77DC  7C 9D 23 78 */	mr r29, r4
/* 800DB8C0 000D77E0  3B 83 00 00 */	addi r28, r3, 0
/* 800DB8C4 000D77E4  3B C5 00 00 */	addi r30, r5, 0
/* 800DB8C8 000D77E8  3B E6 00 00 */	addi r31, r6, 0
/* 800DB8CC 000D77EC  88 84 00 00 */	lbz r4, 0(r4)
/* 800DB8D0 000D77F0  7C 80 07 74 */	extsb r0, r4
/* 800DB8D4 000D77F4  2C 00 00 FF */	cmpwi r0, 0xff
/* 800DB8D8 000D77F8  41 82 00 24 */	beq lbl_800DB8FC
/* 800DB8DC 000D77FC  88 7E 00 00 */	lbz r3, 0(r30)
/* 800DB8E0 000D7800  7C 60 07 74 */	extsb r0, r3
/* 800DB8E4 000D7804  2C 00 00 FF */	cmpwi r0, 0xff
/* 800DB8E8 000D7808  41 82 00 14 */	beq lbl_800DB8FC
/* 800DB8EC 000D780C  7C 80 07 75 */	extsb. r0, r4
/* 800DB8F0 000D7810  41 82 00 0C */	beq lbl_800DB8FC
/* 800DB8F4 000D7814  7C 60 07 75 */	extsb. r0, r3
/* 800DB8F8 000D7818  40 82 00 0C */	bne lbl_800DB904
lbl_800DB8FC:
/* 800DB8FC 000D781C  38 60 FF 80 */	li r3, -128
/* 800DB900 000D7820  48 00 01 88 */	b lbl_800DBA88
lbl_800DB904:
/* 800DB904 000D7824  7F A3 EB 78 */	mr r3, r29
/* 800DB908 000D7828  48 02 B2 59 */	bl strlen
/* 800DB90C 000D782C  28 03 00 20 */	cmplwi r3, 0x20
/* 800DB910 000D7830  41 81 00 14 */	bgt lbl_800DB924
/* 800DB914 000D7834  7F C3 F3 78 */	mr r3, r30
/* 800DB918 000D7838  48 02 B2 49 */	bl strlen
/* 800DB91C 000D783C  28 03 00 20 */	cmplwi r3, 0x20
/* 800DB920 000D7840  40 81 00 0C */	ble lbl_800DB92C
lbl_800DB924:
/* 800DB924 000D7844  38 60 FF F4 */	li r3, -12
/* 800DB928 000D7848  48 00 01 60 */	b lbl_800DBA88
lbl_800DB92C:
/* 800DB92C 000D784C  38 7C 00 00 */	addi r3, r28, 0
/* 800DB930 000D7850  38 81 00 18 */	addi r4, r1, 0x18
/* 800DB934 000D7854  4B FF A8 9D */	bl __CARDGetControlBlock
/* 800DB938 000D7858  2C 03 00 00 */	cmpwi r3, 0
/* 800DB93C 000D785C  40 80 00 08 */	bge lbl_800DB944
/* 800DB940 000D7860  48 00 01 48 */	b lbl_800DBA88
lbl_800DB944:
/* 800DB944 000D7864  80 61 00 18 */	lwz r3, 0x18(r1)
/* 800DB948 000D7868  3A E0 FF FF */	li r23, -1
/* 800DB94C 000D786C  3B 00 FF FF */	li r24, -1
/* 800DB950 000D7870  4B FF C4 51 */	bl __CARDGetDirBlock
/* 800DB954 000D7874  3B 43 00 00 */	addi r26, r3, 0
/* 800DB958 000D7878  3B 7A 00 00 */	addi r27, r26, 0
/* 800DB95C 000D787C  3B 20 00 00 */	li r25, 0
lbl_800DB960:
/* 800DB960 000D7880  88 1B 00 00 */	lbz r0, 0(r27)
/* 800DB964 000D7884  28 00 00 FF */	cmplwi r0, 0xff
/* 800DB968 000D7888  41 82 00 68 */	beq lbl_800DB9D0
/* 800DB96C 000D788C  80 8D A3 58 */	lwz r4, __CARDDiskID-_SDA_BASE_(r13)
/* 800DB970 000D7890  38 7B 00 00 */	addi r3, r27, 0
/* 800DB974 000D7894  38 A0 00 04 */	li r5, 4
/* 800DB978 000D7898  48 02 8E 81 */	bl memcmp
/* 800DB97C 000D789C  2C 03 00 00 */	cmpwi r3, 0
/* 800DB980 000D78A0  40 82 00 50 */	bne lbl_800DB9D0
/* 800DB984 000D78A4  80 8D A3 58 */	lwz r4, __CARDDiskID-_SDA_BASE_(r13)
/* 800DB988 000D78A8  38 7B 00 04 */	addi r3, r27, 4
/* 800DB98C 000D78AC  38 A0 00 02 */	li r5, 2
/* 800DB990 000D78B0  38 84 00 04 */	addi r4, r4, 4
/* 800DB994 000D78B4  48 02 8E 65 */	bl memcmp
/* 800DB998 000D78B8  2C 03 00 00 */	cmpwi r3, 0
/* 800DB99C 000D78BC  40 82 00 34 */	bne lbl_800DB9D0
/* 800DB9A0 000D78C0  38 7B 00 00 */	addi r3, r27, 0
/* 800DB9A4 000D78C4  38 9D 00 00 */	addi r4, r29, 0
/* 800DB9A8 000D78C8  4B FF E6 71 */	bl __CARDCompareFileName
/* 800DB9AC 000D78CC  2C 03 00 00 */	cmpwi r3, 0
/* 800DB9B0 000D78D0  41 82 00 08 */	beq lbl_800DB9B8
/* 800DB9B4 000D78D4  7F 37 CB 78 */	mr r23, r25
lbl_800DB9B8:
/* 800DB9B8 000D78D8  38 7B 00 00 */	addi r3, r27, 0
/* 800DB9BC 000D78DC  38 9E 00 00 */	addi r4, r30, 0
/* 800DB9C0 000D78E0  4B FF E6 59 */	bl __CARDCompareFileName
/* 800DB9C4 000D78E4  2C 03 00 00 */	cmpwi r3, 0
/* 800DB9C8 000D78E8  41 82 00 08 */	beq lbl_800DB9D0
/* 800DB9CC 000D78EC  7F 38 CB 78 */	mr r24, r25
lbl_800DB9D0:
/* 800DB9D0 000D78F0  3B 39 00 01 */	addi r25, r25, 1
/* 800DB9D4 000D78F4  2C 19 00 7F */	cmpwi r25, 0x7f
/* 800DB9D8 000D78F8  3B 7B 00 40 */	addi r27, r27, 0x40
/* 800DB9DC 000D78FC  41 80 FF 84 */	blt lbl_800DB960
/* 800DB9E0 000D7900  2C 17 FF FF */	cmpwi r23, -1
/* 800DB9E4 000D7904  40 82 00 14 */	bne lbl_800DB9F8
/* 800DB9E8 000D7908  80 61 00 18 */	lwz r3, 0x18(r1)
/* 800DB9EC 000D790C  38 80 FF FC */	li r4, -4
/* 800DB9F0 000D7910  4B FF A8 91 */	bl __CARDPutControlBlock
/* 800DB9F4 000D7914  48 00 00 94 */	b lbl_800DBA88
lbl_800DB9F8:
/* 800DB9F8 000D7918  2C 18 FF FF */	cmpwi r24, -1
/* 800DB9FC 000D791C  41 82 00 14 */	beq lbl_800DBA10
/* 800DBA00 000D7920  80 61 00 18 */	lwz r3, 0x18(r1)
/* 800DBA04 000D7924  38 80 FF F9 */	li r4, -7
/* 800DBA08 000D7928  4B FF A8 79 */	bl __CARDPutControlBlock
/* 800DBA0C 000D792C  48 00 00 7C */	b lbl_800DBA88
lbl_800DBA10:
/* 800DBA10 000D7930  56 E0 30 32 */	slwi r0, r23, 6
/* 800DBA14 000D7934  7F 7A 02 14 */	add r27, r26, r0
/* 800DBA18 000D7938  38 7B 00 00 */	addi r3, r27, 0
/* 800DBA1C 000D793C  4B FF E6 65 */	bl __CARDAccess
/* 800DBA20 000D7940  7C 64 1B 79 */	or. r4, r3, r3
/* 800DBA24 000D7944  40 80 00 10 */	bge lbl_800DBA34
/* 800DBA28 000D7948  80 61 00 18 */	lwz r3, 0x18(r1)
/* 800DBA2C 000D794C  4B FF A8 55 */	bl __CARDPutControlBlock
/* 800DBA30 000D7950  48 00 00 58 */	b lbl_800DBA88
lbl_800DBA34:
/* 800DBA34 000D7954  38 9E 00 00 */	addi r4, r30, 0
/* 800DBA38 000D7958  38 7B 00 08 */	addi r3, r27, 8
/* 800DBA3C 000D795C  38 A0 00 20 */	li r5, 0x20
/* 800DBA40 000D7960  48 02 B0 29 */	bl strncpy
/* 800DBA44 000D7964  3C 60 80 00 */	lis r3, 0x800000F8@ha
/* 800DBA48 000D7968  80 03 00 F8 */	lwz r0, 0x800000F8@l(r3)
/* 800DBA4C 000D796C  54 1D F0 BE */	srwi r29, r0, 2
/* 800DBA50 000D7970  4B FE DF 2D */	bl OSGetTime
/* 800DBA54 000D7974  38 DD 00 00 */	addi r6, r29, 0
/* 800DBA58 000D7978  38 A0 00 00 */	li r5, 0
/* 800DBA5C 000D797C  48 02 7C 59 */	bl __div2i
/* 800DBA60 000D7980  90 9B 00 28 */	stw r4, 0x28(r27)
/* 800DBA64 000D7984  38 7C 00 00 */	addi r3, r28, 0
/* 800DBA68 000D7988  38 9F 00 00 */	addi r4, r31, 0
/* 800DBA6C 000D798C  4B FF C4 D5 */	bl __CARDUpdateDir
/* 800DBA70 000D7990  7C 7B 1B 79 */	or. r27, r3, r3
/* 800DBA74 000D7994  40 80 00 10 */	bge lbl_800DBA84
/* 800DBA78 000D7998  80 61 00 18 */	lwz r3, 0x18(r1)
/* 800DBA7C 000D799C  7F 64 DB 78 */	mr r4, r27
/* 800DBA80 000D79A0  4B FF A8 01 */	bl __CARDPutControlBlock
lbl_800DBA84:
/* 800DBA84 000D79A4  7F 63 DB 78 */	mr r3, r27
lbl_800DBA88:
/* 800DBA88 000D79A8  BA E1 00 24 */	lmw r23, 0x24(r1)
/* 800DBA8C 000D79AC  80 01 00 4C */	lwz r0, 0x4c(r1)
/* 800DBA90 000D79B0  38 21 00 48 */	addi r1, r1, 0x48
/* 800DBA94 000D79B4  7C 08 03 A6 */	mtlr r0
/* 800DBA98 000D79B8  4E 80 00 20 */	blr

.global CARDRename
CARDRename:
/* 800DBA9C 000D79BC  7C 08 02 A6 */	mflr r0
/* 800DBAA0 000D79C0  3C C0 80 0D */	lis r6, __CARDSyncCallback@ha
/* 800DBAA4 000D79C4  90 01 00 04 */	stw r0, 4(r1)
/* 800DBAA8 000D79C8  38 C6 51 C4 */	addi r6, r6, __CARDSyncCallback@l
/* 800DBAAC 000D79CC  94 21 FF E0 */	stwu r1, -0x20(r1)
/* 800DBAB0 000D79D0  93 E1 00 1C */	stw r31, 0x1c(r1)
/* 800DBAB4 000D79D4  3B E3 00 00 */	addi r31, r3, 0
/* 800DBAB8 000D79D8  4B FF FD F5 */	bl CARDRenameAsync
/* 800DBABC 000D79DC  2C 03 00 00 */	cmpwi r3, 0
/* 800DBAC0 000D79E0  40 80 00 08 */	bge lbl_800DBAC8
/* 800DBAC4 000D79E4  48 00 00 0C */	b lbl_800DBAD0
lbl_800DBAC8:
/* 800DBAC8 000D79E8  7F E3 FB 78 */	mr r3, r31
/* 800DBACC 000D79EC  4B FF A9 55 */	bl __CARDSync
lbl_800DBAD0:
/* 800DBAD0 000D79F0  80 01 00 24 */	lwz r0, 0x24(r1)
/* 800DBAD4 000D79F4  83 E1 00 1C */	lwz r31, 0x1c(r1)
/* 800DBAD8 000D79F8  38 21 00 20 */	addi r1, r1, 0x20
/* 800DBADC 000D79FC  7C 08 03 A6 */	mtlr r0
/* 800DBAE0 000D7A00  4E 80 00 20 */	blr
